(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0c19d4"],{4794:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"q-pa-md"},[s("q-dialog",{model:{value:t.history,callback:function(e){t.history=e},expression:"history"}},[s("q-card",[s("q-card-section",[t._v("\r\n        Haz click en la orden para visualizarlo en el mapa\r\n      ")]),s("q-card-section",[s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.order_history,(function(e,a){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:a,attrs:{clickable:""},on:{click:function(s){return t.openWindow(e.order_id)}}},[s("q-item-section",[s("q-item-label",[t._v("Orden ID: "+t._s(e.order_id))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.details))])],1)],1)})),1)],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1),s("q-dialog",{model:{value:t.dialogFind,callback:function(e){t.dialogFind=e},expression:"dialogFind"}},[s("q-card",[s("q-card-section",[t._v("\r\n        Seleccionar una direccion guardada\r\n      ")]),s("q-card-section",[s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.address_list,(function(e,a){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:a,attrs:{clickable:""},on:{click:function(e){return t.selectAddress(a)}}},[s("q-item-section",[s("q-item-label",[t._v(t._s(e.name))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.reference))])],1)],1)})),1)],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.dialogSave,callback:function(e){t.dialogSave=e},expression:"dialogSave"}},[s("q-card",{staticStyle:{"min-width":"350px"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v("Guardar direccion como:")])]),s("q-card-section",{staticClass:"q-pt-none"},[s("q-input",{attrs:{dense:"",autofocus:""},model:{value:t.addressSave,callback:function(e){t.addressSave=e},expression:"addressSave"}})],1),s("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar"}}),s("q-btn",{attrs:{flat:"",label:"Guardar direccion"},on:{click:t.saveAddressLocal}})],1)],1)],1),s("div",{staticClass:"row wrap items-center"},[s("div",{staticClass:"col-7"},[[s("div",{staticClass:"q-py-xs"},[s("q-banner",{class:t.sendOrderMsg.color+" text-white",attrs:{rounded:""}},[t._v("\r\n            ID Orden: "+t._s(t.sendOrderMsg.id)+" "),s("br"),t._v("\r\n            "+t._s(t.sendOrderMsg.msg)+"\r\n          ")])],1)]],2),s("div",{staticClass:"col-5"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-4"},[s("div",{staticClass:"q-gutter-sm text-right"},[s("div",{staticClass:"text-grey-7"},[t._v("Gastos de envío")]),t._v("\r\n            "+t._s(t.deliveryCost)+"\r\n          ")])]),s("div",{staticClass:"col"},[s("div",{staticClass:"q-gutter-sm text-right "},[s("q-btn",{staticClass:"q-mb-sm",attrs:{loading:t.loadDeliveryBtn,color:"primary",size:"10px"},on:{click:t.calculateDelivery}},[t._v("Calcular envío")]),s("q-btn",{staticClass:"q-mb-sm",attrs:{disabled:""==t.details,loading:t.loadBtn,color:"green",size:"10px"},on:{click:t.sendOrder}},[t._v("Finalizar Pedido")]),s("q-btn",{attrs:{flat:"",round:"",icon:"history"},on:{click:function(e){t.history=!0}}},[s("q-tooltip",{attrs:{anchor:"top middle",self:"center middle"}},[t._v("\r\n                  Historial\r\n                ")])],1)],1)])])])]),s("q-card",{attrs:{flat:"",bordered:""}},[s("q-card-section",[s("div",{staticClass:"row q-gutter-x-lg no-wrap justify-center q-py-xs"},[s("div",{staticClass:"col-3"},[s("div",{staticClass:"text-center text-grey-6 q-pb-xs"},[t._v("DATOS")]),s("q-card",{attrs:{flat:"",bordered:""}},[s("q-card-section",[s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Telefono"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:t.findUser}})]},proxy:!0}]),model:{value:t.celClient,callback:function(e){t.celClient=e},expression:"celClient"}}),s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Cliente"},model:{value:t.nameClient,callback:function(e){t.nameClient=e},expression:"nameClient"}}),s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Detalle",autogrow:""},model:{value:t.details,callback:function(e){t.details=e},expression:"details"}}),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Razon Social"},model:{value:t.nameNit,callback:function(e){t.nameNit=e},expression:"nameNit"}})],1),s("div",{staticClass:"col"},[s("q-input",{staticClass:"q-pb-xs q-ml-xs",attrs:{filled:"",label:"NIT"},model:{value:t.nit,callback:function(e){t.nit=e},expression:"nit"}})],1)]),s("div",[s("q-input",{attrs:{id:"image",filled:"",type:"file",hint:"Imagen (Opcional)"},on:{input:function(e){t.order_images=e[0]}}})],1)],1)],1)],1),s("div",{staticClass:"col-4"},[s("div",{staticClass:"text-center text-grey-6 q-pb-xs"},[t._v("ORIGEN")]),s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col-9"},[s("q-input",{attrs:{filled:"",label:"URL WhatsApp"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:function(e){return t.findMap("1")}}})]},proxy:!0}]),model:{value:t.urlWpFrom,callback:function(e){t.urlWpFrom=e},expression:"urlWpFrom"}})],1),s("div",{staticClass:"col-3 q-gutter-sm text-right"},[s("q-btn",{attrs:{flat:"",round:"",icon:"find_in_page"},on:{click:function(e){return t.findAddress("1")}}},[s("q-tooltip",{attrs:{anchor:"top middle",self:"center middle"}},[t._v("\r\n                  Buscar dirección guardada\r\n                ")])],1),s("q-btn",{attrs:{flat:"",round:"",icon:"save"},on:{click:function(e){return t.saveAddress("1")}}},[s("q-tooltip",{attrs:{anchor:"top middle",self:"center middle"}},[t._v("\r\n                  Guardar esta dirección\r\n                ")])],1)],1)]),s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Recoger desde",autogrow:""},model:{value:t.from_address,callback:function(e){t.from_address=e},expression:"from_address"}}),s("q-card",{attrs:{flat:"",bordered:""}},[s("div",{staticStyle:{width:"100%",height:"300px"}},[s("l-map",{ref:"myMapFrom",staticStyle:{"z-index":"0"},attrs:{zoom:t.zoom,center:t.from_center,options:{zoomControl:!1}},on:{click:t.updateMarkerFrom}},[s("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),s("l-marker",{attrs:{"lat-lng":t.from_center}})],1)],1)])],1),s("div",{staticClass:"col-4"},[s("div",{staticClass:"text-center text-grey-6 q-pb-xs"},[t._v("DESTINO")]),s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col-9"},[s("q-input",{attrs:{filled:"",label:"URL WhatsApp"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:function(e){return t.findMap("2")}}})]},proxy:!0}]),model:{value:t.urlWpTo,callback:function(e){t.urlWpTo=e},expression:"urlWpTo"}})],1),s("div",{staticClass:"col-3 q-gutter-sm text-right"},[s("q-btn",{attrs:{flat:"",round:"",icon:"find_in_page"},on:{click:function(e){return t.findAddress("2")}}},[s("q-tooltip",{attrs:{anchor:"top middle",self:"center middle"}},[t._v("\r\n                  Buscar dirección guardada\r\n                ")])],1),s("q-btn",{attrs:{flat:"",round:"",icon:"save"},on:{click:function(e){return t.saveAddress("2")}}},[s("q-tooltip",{attrs:{anchor:"top middle",self:"center middle"}},[t._v("\r\n                  Guardar esta dirección\r\n                ")])],1)],1)]),s("q-input",{staticClass:"q-pb-xs",attrs:{filled:"",label:"Entregar En",autogrow:""},model:{value:t.to_address,callback:function(e){t.to_address=e},expression:"to_address"}}),s("q-card",{attrs:{flat:"",bordered:""}},[s("div",{staticStyle:{width:"100%",height:"300px"}},[s("l-map",{ref:"myMapTo",staticStyle:{"z-index":"0"},attrs:{zoom:t.zoom,center:t.to_center,options:{zoomControl:!1}},on:{click:t.updateMarkerTo}},[s("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),s("l-marker",{attrs:{"lat-lng":t.to_center}})],1)],1)])],1)])])],1)],1)},r=[],i=s("967e"),n=s.n(i),o=(s("96cf"),s("c1df"),s("2699")),l=s("a40a"),d=s("4e2b"),c=s("e11eb");s("6cc5"),s("9490");delete c["Icon"].Default.prototype._getIconUrl,c["Icon"].Default.mergeOptions({iconRetinaUrl:s("584d"),iconUrl:s("6397"),shadowUrl:s("e2b9")});var p={components:{"l-map":o["a"],"l-tile-layer":l["a"],"l-marker":d["a"]},data:function(){return{dialogSave:!1,addressSave:"",dialogFind:!1,history:!1,celClient:"",urlWpFrom:"",nameClient:"",urlWpTo:"",order_images:null,details:"",nit:"",nameNit:"",from_address:"",from_center:[-17.783384,-63.18203],to_address:"",to_center:[-17.783384,-63.18203],selectRef:"",selectRefFind:"",deliveryCost:0,sendOrderMsg:{id:-1,color:"bg-white",msg:"No hay pedido realizado",order:{}},loadDeliveryBtn:!1,loadBtn:!1,user_identifier:"ff90ca93c18701",operator_token:"ca3686de8b9cd13abcb362e09e494210",access_token:"eace9570aa38e82929af176b77cee80b30f83081aacfd3149338c1081d7fdbff",zoom:13,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},methods:{openWindow:function(t){window.open("https://patioserviceonline.com/sc/#/map/order/"+t)},updateMarkerFrom:function(t){this.from_center=[t.latlng.lat,t.latlng.lng]},updateMarkerTo:function(t){this.to_center=[t.latlng.lat,t.latlng.lng]},findMap:function(t){if("1"==t){var e="https://maps.google.com/maps?q=";if(0==this.urlWpFrom.indexOf(e)){var s="%2C",a="&z=17&hl=es",r=this.urlWpFrom.substring(e.length,this.urlWpFrom.indexOf(s)),i=this.urlWpFrom.substring(this.urlWpFrom.indexOf(s)+s.length,this.urlWpFrom.indexOf(a));this.from_center=[parseFloat(r),parseFloat(i)]}else alert("URL del mapa es invalido")}else{e="https://maps.google.com/maps?q=";if(0==this.urlWpTo.indexOf(e)){s="%2C",a="&z=17&hl=es",r=this.urlWpTo.substring(e.length,this.urlWpTo.indexOf(s)),i=this.urlWpTo.substring(this.urlWpTo.indexOf(s)+s.length,this.urlWpTo.indexOf(a));this.to_center=[parseFloat(r),parseFloat(i)]}else alert("URL del mapa es invalido")}},calculateDelivery:function(){var t,e;return n.a.async((function(s){while(1)switch(s.prev=s.next){case 0:return this.deliveryCost=0,this.loadDeliveryBtn=!0,t="https://prod-fatafat-new.jugnoo.in:4030/get_all_details?device_type=0&app_version=436&to_latitude="+JSON.stringify(this.to_center[0])+"&access_token="+this.access_token+"&login_type=0&from_latitude="+JSON.stringify(this.from_center[0])+"&locale=es&operator_token="+this.operator_token+"&to_longitude="+JSON.stringify(this.to_center[1])+"&customer_package_name=com.movapps.mav.patioservice&from_longitude="+JSON.stringify(this.from_center[1]),s.prev=3,s.next=6,n.a.awrap(this.$axios.get(t));case 6:e=s.sent,e.data.delivery_charges?this.deliveryCost=e.data.delivery_charges.estimated_charges:alert(e.data.message),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](3),console.log("Error al calcular el costo de envio: ",s.t0);case 13:this.loadDeliveryBtn=!1;case 14:case"end":return s.stop()}}),null,this,[[3,10]])},sendOrder:function(){var t,e,s,a;return n.a.async((function(r){while(1)switch(r.prev=r.next){case 0:return this.loadBtn=!0,t="https://prod-fatafat-new.jugnoo.in:4030/place_order",e="",s=new URLSearchParams,this.order_images&&s.append("order_images",this.order_images),""!=this.celClient&&(e+="*CEL: "+this.celClient+" "),""!=this.nameClient&&(e+="*CLI: "+this.nameClient+" "),""==this.nameNit&&""==this.nit||(e+="*NIT: "+this.nit+" - "+this.nameNit+" "),e+="DET: "+this.details,s.append("details",e),s.append("from_address",this.from_address),s.append("from_latitude",JSON.stringify(this.from_center[0])),s.append("from_longitude",JSON.stringify(this.from_center[1])),s.append("payment_mode","1"),s.append("to_address",this.to_address),s.append("to_latitude",JSON.stringify(this.to_center[0])),s.append("to_longitude",JSON.stringify(this.to_center[1])),s.append("is_immediate","1"),s.append("user_identifier",this.user_identifier),s.append("app_version","436"),s.append("device_type","0"),s.append("login_type","0"),s.append("operator_token",this.operator_token),s.append("customer_package_name","com.movapps.mav.patioservice"),s.append("locale","es"),s.append("access_token",this.access_token),r.prev=26,r.next=29,n.a.awrap(this.$axios.post(t,s));case 29:a=r.sent,a.data.order_id?(this.sendOrderMsg.id=a.data.order_id,this.sendOrderMsg.msg=a.data.message,this.sendOrderMsg.color="bg-green-5",this.$store.commit("orderHistory/updateHistory",{order_id:a.data.order_id,details:this.details}),this.clearInputs()):(this.sendOrderMsg.id="ERROR",this.sendOrderMsg.msg=a.data.message,this.sendOrderMsg.color="bg-red-5"),r.next=36;break;case 33:r.prev=33,r.t0=r["catch"](26),console.log("Error SEND ORDER",r.t0);case 36:this.loadBtn=!1;case 37:case"end":return r.stop()}}),null,this,[[26,33]])},findAddress:function(t){this.selectRefFind=t,this.dialogFind=!0},selectAddress:function(t){var e=this.$store.getters["address/getItem"](t);"1"==this.selectRefFind?(this.from_address=e.reference,this.from_center=e.latlng):(this.to_address=e.reference,this.to_center=e.latlng),this.dialogFind=!1},saveAddressLocal:function(){var t={};if("1"==this.selectRef)t={name:this.addressSave,reference:this.from_address,latlng:this.from_center};else{if("2"!=this.selectRef)return;t={name:this.addressSave,reference:this.to_address,latlng:this.to_center}}this.$store.commit("address/updateList",t),this.dialogSave=!1,this.addressSave=""},saveAddress:function(t){this.selectRef=t,"1"==t?""!=this.from_address&&(this.dialogSave=!0):""!=this.to_address&&(this.dialogSave=!0)},clearInputs:function(){this.details="",this.order_images=null,this.from_address="",this.to_address="",this.urlWpFrom="",this.urlWpTo=""},findUser:function(){return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:this.celClient;case 1:case"end":return t.stop()}}),null,this)}},computed:{order_history:{get:function(){return this.$store.getters["orderHistory/getHistory"]}},address_list:{get:function(){return this.$store.getters["address/getList"]}}}},u=p,m=s("2877"),f=Object(m["a"])(u,a,r,!1,null,null,null);e["default"]=f.exports}}]);