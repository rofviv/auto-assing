(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0a3c8b"],{"043d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-pa-md"},[a("div",{staticClass:"text-center text-h6"},[t._v("LIMITAR COBERTURA")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("q-input",{attrs:{filled:"",type:"file",hint:"Selecciona un excel"},on:{input:function(e){t.file=e[0]}}})],1),a("div",{staticClass:"col-6"},[a("q-btn",{attrs:{color:"green"},on:{click:t.readXlsx}},[t._v("Cargar Archivo")])],1)]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"row",attrs:{disabled:!t.isEnabled}},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"text-h6"},[t._v("MANUALMENTE")])])]),a("div",{staticClass:"row q-pb-md"},[a("div",{staticClass:"col-4"},[t._v("\n          "+t._s(t.texto)+"\n        ")]),a("div",{staticClass:"col-3"},[a("q-input",{attrs:{type:"number",disable:t.disableBtn,outlined:"",label:"Kilometro"},model:{value:t.kilometros,callback:function(e){t.kilometros=e},expression:"kilometros"}})],1),a("div",{staticClass:"col-3"},[a("q-btn",{attrs:{color:"green",disable:t.disableBtn},on:{click:t.updateMerchant}},[t._v("Aplicar")])],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[t.isOpening?[a("div",[t._v("\n              Actualizando cobertura...\n              "),a("q-linear-progress",{attrs:{color:"green",indeterminate:""}})],1)]:t._e()],2)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-11"},[a("q-card",{staticClass:"my-card",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Historial")])]),a("q-card-section",[a("q-scroll-area",{ref:"scrollAreaDelivery",staticStyle:{height:"300px","max-width":"100%"}},t._l(t.arrayHistoryDelivery,(function(e,s){return a("div",{key:s},[t._v("\n                  $ "),a("span",{staticClass:"text-weight-light"},[t._v(t._s(e))])])})),0)],1)],1)],1)])])])],1)},r=[],i=a("967e"),n=a.n(i),c=(a("96cf"),a("1146")),l=a.n(c),o=a("c1df"),d=a.n(o),u=[],h={name:"AutoAssign",data:function(){return{file:null,merchantList:[],texto:"",disableBtn:!1,kilometros:7,isOpening:!1,isEnabled:!1,active:!1,arrayHistoryDelivery:[],access_token:"5e26d40edd82f1035e8fe0d12e7304df"}},methods:{readXlsx:function(){if(this.file){var t=new FileReader;t.onload=function(t){var e=t.target.result,a=l.a.read(e,{type:"binary"}),s=a.Sheets[a.SheetNames[0]],r=l.a.utils.sheet_to_json(s,{header:1});u=r,alert("Se cargaron "+u.length+" valores.")},t.onerror=function(t){console.log(t)},t.readAsBinaryString(this.file),this.isEnabled=!0}else alert("SELECCIONA UN ARCHIVO")},asyncForEach:function(t,e){var a;return n.a.async((function(s){while(1)switch(s.prev=s.next){case 0:a=0;case 1:if(!(a<t.length)){s.next=8;break}return s.next=4,n.a.awrap(e(t[a],a,t));case 4:this.texto=a+1+" de "+t.length;case 5:a++,s.next=1;break;case 8:case"end":return s.stop()}}),null,this)},updateMerchant:function(){var t,e=this;return n.a.async((function(a){while(1)switch(a.prev=a.next){case 0:this.merchantList=u,this.merchantList.length>0?""!=this.kilometros?(this.disableBtn=!0,this.isOpening=!0,this.arrayHistoryDelivery.push("Cambiando el radio de cobertura a "+this.kilometros+" Km ("+d()().format("LTS")+")"),t=function(){return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.a.awrap(e.asyncForEach(e.merchantList,(function(t){return n.a.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.a.awrap(e.updateHttpMerchant(t[0],1));case 2:case"end":return a.stop()}}))})));case 2:e.arrayHistoryDelivery.push("Se cambio correctamente a "+e.kilometros+" Km... ("+d()().format("LTS")+")");case 3:case"end":return t.stop()}}))},t()):alert("ESPECIFICA LOS KILOMETROS"):alert("DEBES CARGAR UN DOCUMENTO");case 2:case"end":return a.stop()}}),null,this)},updateHttpMerchant:function(t,e){var a,s,r;return n.a.async((function(e){while(1)switch(e.prev=e.next){case 0:return a="https://prod-fresh-api.jugnoo.in:4040/update_restaurant_profile",e.prev=1,s=new URLSearchParams,s.append("restaurant_id",t),s.append("request_radius",this.kilometros),s.append("token",this.access_token),e.next=8,n.a.awrap(this.$axios({url:a,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:s}));case 8:r=e.sent,this.arrayHistoryDelivery.push("ID "+t+": "+r.data.message+" ("+d()().format("LTS")+")"),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),console.log("Update Merchant ",e.t0);case 15:this.disableBtn=!1,this.isOpening=!1;case 17:case"end":return e.stop()}}),null,this,[[1,12]])}}},p=h,v=a("2877"),f=Object(v["a"])(p,s,r,!1,null,null,null);e["default"]=f.exports}}]);