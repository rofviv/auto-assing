(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"3ecf":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{staticClass:"q-pa-md"},[t("q-select",{attrs:{"option-label":"city","emit-value":"","map-options":"","option-value":"id",options:e.cityOptions,label:"Ciudad"},on:{input:e.cambiarCiudad},model:{value:e.citySelect,callback:function(a){e.citySelect=a},expression:"citySelect"}}),t("q-separator",{staticClass:"q-my-md"}),t("div",{staticClass:"row"},[t("div",{staticClass:"col-6"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-4"},[t("div",{staticClass:"text-h6"},[e._v("MENUS")])]),t("div",{staticClass:"col-2 q-mb-sm"},[t("q-input",{attrs:{type:"number",outlined:"",label:"Tiempo (Seg.)"},on:{input:e.validateNumber},model:{value:e.time_refresh,callback:function(a){e.time_refresh=a},expression:"time_refresh"}})],1)]),t("div",{staticClass:"row q-pb-md"},[t("div",{staticClass:"col-4"},[t("q-toggle",{attrs:{label:"Auto Asignar"},on:{input:e.change_mode},model:{value:e.active,callback:function(a){e.active=a},expression:"active"}})],1),t("div",{staticClass:"col-6"},[t("q-chip",[t("q-avatar",{attrs:{color:"blue","text-color":"white"}},[e._v(e._s(e.cantOrdersTotal))]),e._v("Pedidos\n          ")],1),t("q-chip",[t("q-avatar",{attrs:{color:"green","text-color":"white"}},[e._v(e._s(e.cantOrderAssigned))]),e._v("Auto Asignados\n          ")],1)],1)]),t("div",{staticClass:"row q-pb-md"},[t("div",{staticClass:"col-4"},[t("q-toggle",{attrs:{label:"Aceptar"},on:{input:e.change_mode_accept},model:{value:e.activeAccept,callback:function(a){e.activeAccept=a},expression:"activeAccept"}})],1),t("div",{staticClass:"col-3"},[t("q-chip",[t("q-avatar",{attrs:{color:"orange","text-color":"white"}},[e._v(e._s(e.cantOrderAccept))]),e._v("Aceptados\n          ")],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-11"},[t("q-card",{staticClass:"my-card",attrs:{flat:"",bordered:""}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Historial MENUS y ACCEPT")])]),t("q-card-section",[t("q-scroll-area",{ref:"scrollAreaMenus",staticStyle:{height:"300px","max-width":"100%"}},e._l(e.arrayHistory,(function(a,r){return t("div",{key:r},[e._v("\n                  $\n                  "),t("span",{staticClass:"text-weight-light"},[e._v(e._s(a))])])})),0)],1)],1)],1)])]),t("div",{staticClass:"col-6"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-4"},[t("div",{staticClass:"text-h6"},[e._v("DELIVERY")])]),t("div",{staticClass:"col-2 q-mb-sm"},[t("q-input",{attrs:{type:"number",outlined:"",label:"Tiempo (Seg.)"},on:{input:e.validateNumberDelivery},model:{value:e.time_refresh_delivery,callback:function(a){e.time_refresh_delivery=a},expression:"time_refresh_delivery"}})],1)]),t("div",{staticClass:"row q-pb-md"},[t("div",{staticClass:"col-4"},[t("q-toggle",{attrs:{label:"Auto Asignar"},on:{input:e.change_mode_delivery},model:{value:e.activeDelivery,callback:function(a){e.activeDelivery=a},expression:"activeDelivery"}})],1),t("div",{staticClass:"col-6"},[t("q-chip",[t("q-avatar",{attrs:{color:"blue","text-color":"white"}},[e._v(e._s(e.cantOrdersTotalDelivery))]),e._v("Pedidos\n          ")],1),t("q-chip",[t("q-avatar",{attrs:{color:"green","text-color":"white"}},[e._v(e._s(e.cantOrderAssignedDelivery))]),e._v("Auto Asignados\n          ")],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-11"},[t("q-card",{staticClass:"my-card",attrs:{flat:"",bordered:""}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Historial DELIVERY")])]),t("q-card-section",[t("q-scroll-area",{ref:"scrollAreaDelivery",staticStyle:{height:"300px","max-width":"100%"}},e._l(e.arrayHistoryDelivery,(function(a,r){return t("div",{key:r},[e._v("\n                  $\n                  "),t("span",{staticClass:"text-weight-light"},[e._v(e._s(a))])])})),0)],1)],1)],1)])])]),t("br"),t("q-input",{attrs:{type:"number",outlined:"",label:"dia"},model:{value:e.diaAnterior,callback:function(a){e.diaAnterior=a},expression:"diaAnterior"}}),t("q-btn",{attrs:{label:"Ejecutar"},on:{click:e.getListaMotos}}),t("q-checkbox",{attrs:{label:"Descuento Motoclick"},model:{value:e.isMotoclick,callback:function(a){e.isMotoclick=a},expression:"isMotoclick"}}),t("div",{staticClass:"row"},[t("div",{staticClass:"col-11"},[t("q-card",{staticClass:"my-card",attrs:{flat:"",bordered:""}},[e._v("\n        "+e._s(e.contadorCreditos)+"\n        "),t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Historial CREDITOS REPARTIDORES")])]),t("q-card-section",[t("q-scroll-area",{ref:"scrollAreaMenus",staticStyle:{height:"300px","max-width":"100%"}},e._l(e.arrayHistoryCreditos,(function(a,r){return t("div",{key:r},[e._v("\n              $\n              "),t("span",{staticClass:"text-weight-light"},[e._v(e._s(a))])])})),0)],1)],1)],1)])],1)},s=[],i=(t("28a5"),t("a34a")),o=t.n(i),c=(t("7514"),t("96cf"),t("c973")),n=t.n(c),l=t("c1df"),d=t.n(l),u=t("18d6"),p=t("21a6"),_={name:"AutoAssign",mounted:function(){this.cargarCiudad(),this.change_mode(),this.change_mode_accept(),this.change_mode_delivery()},data:function(){return{isMotoclick:!1,arrayHistory:[],active:!1,cantOrdersTotal:0,cantOrderAssigned:0,refresh_handler:null,time_refresh:60,arrayHistoryDelivery:[],activeDelivery:!1,cantOrdersTotalDelivery:0,cantOrderAssignedDelivery:0,refresh_handler_delivery:null,time_refresh_delivery:60,time_refresh_accept:1,activeAccept:!1,cantOrderAccept:0,refresh_handler_accept:null,access_token:"5e26d40edd82f1035e8fe0d12e7304df",access_token_aux:"845c88964029c3c89451c8925a5bf093",citySelect:395,cityOptions:[{city:"Santa Cruz",id:395},{city:"Cochabamba",id:704},{city:"La Paz",id:818},{city:"Tarija",id:859},{city:"Potosi",id:1796},{city:"Sucre",id:933},{city:"Arequipa",id:786},{city:"Montevideo",id:997},{city:"San Jose de Mayo",id:3190}],time_refresh_creditos:45,comprobandoCreditos:!1,refresh_handler_creditos:null,arrayHistoryCreditos:[],horaScript:"00",arrayListaMotos:[],contadorCreditos:"",arrayMotosCSV:[],diaAnterior:1,ciudadNombre:""}},methods:{comprobarHora:function(){if(395==this.citySelect||818==this.citySelect){var e=new Date,a=e.getHours();a==this.horaScript?this.comprobandoCreditos?this.arrayHistoryCreditos.push("Script en ejecución"+d()().format("LTS")+")"):(this.arrayHistoryCreditos.push("Ejecutando el script ("+d()().format("LTS")+")"),this.comprobandoCreditos=!0,this.getListaMotos()):(this.comprobandoCreditos=!1,this.contadorCreditos="",this.arrayHistoryCreditos=[],this.arrayHistoryCreditos.push("Esperando la hora "+this.horaScript+"  para ejecutar el script ("+d()().format("LTS")+")")),this.reset_timer_creditos()}else this.arrayHistoryCreditos.push("El Script no se ejcutara en esta ciudad ("+d()().format("LTS")+")")},getListaMotos:function(){var e=this;return n()(o.a.mark((function a(){var t,r,s,i,c,l,u;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t=prompt("Ingresa la clave para realizar esta acción"),"sistemas"!=t){a.next=25;break}return r=d()().subtract(e.diaAnterior,"days").format("YYYY-MM-DD"),e.arrayMotosCSV.push("ID,NOMBRE,CARRERAS,SALDO CREDITO,BLOQUEADO,FECHA\n"),e.arrayHistoryCreditos.push("Obteniendo lista de repartidores ("+d()().format("LTS")+")"),e.ciudadNombre=e.cityOptions.find((function(a){return a.id==e.citySelect})).city,s=e.isMotoclick?1:0,i=e.isMotoclick?3:1,c="https://patioserviceonline.com/api/v1/controllers/erpController.php?type=cant_pedidos_driver_fecha&fecha="+r+"&ciudad="+e.ciudadNombre+"&motoclick="+s,a.prev=9,a.next=12,e.$axios.get(c);case 12:return l=a.sent,e.arrayListaMotos=l.data,e.arrayHistoryCreditos.push("Cantidad de repartidores obtenidos: "+e.arrayListaMotos.length+" ("+d()().format("LTS")+")"),u=function(){var a=n()(o.a.mark((function a(){var t;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.asyncForEach(e.arrayListaMotos,function(){var a=n()(o.a.mark((function a(t){return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.debitarCreditoMoto(t,t.total_pedidos*i,r);case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 2:t=new Blob(e.arrayMotosCSV,{type:"text/csv;charset=utf-8"}),p.saveAs(t,"ReporteDeCreditos.csv"),e.arrayMotosCSV=[];case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),a.next=18,u();case 18:a.next=23;break;case 20:a.prev=20,a.t0=a["catch"](9),console.log("GET MOTOS ERROR",a.t0);case 23:a.next=26;break;case 25:alert("Clave incorrecta");case 26:case"end":return a.stop()}}),a,null,[[9,20]])})))()},debitarCreditoMoto:function(e,a,t){var r=this;return n()(o.a.mark((function s(){var i,c,n;return o.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!(parseInt(a)>0)){s.next=27;break}return r.arrayHistoryCreditos.push("Debitando "+a+" creditos al driver id "+e.driver_id+" de la fecha "+t+" ("+d()().format("LTS")+")"),i="https://api-panels.jugnoo.in:8020/give_user_credits",c=new URLSearchParams,c.append("type","2"),c.append("amount",a),c.append("reason",a+" pedidos de la fecha "+t),c.append("user_id",e.driver_id),c.append("user_type","1"),c.append("token",r.access_token_aux),s.prev=10,s.next=13,r.$axios.post(i,c);case 13:if(n=s.sent,"Success"!=n.data.message){s.next=19;break}return s.next=17,r.verificarCreditos(e,a,t);case 17:s.next=20;break;case 19:r.arrayHistoryCreditos.push("Hubo un problema al debitar los creditos del driver ID: "+e.driver_id+" ("+d()().format("LTS")+")");case 20:s.next=25;break;case 22:s.prev=22,s.t0=s["catch"](10),console.log("No se pudo debitar creditos del id "+e.driver_id,s.t0);case 25:s.next=28;break;case 27:r.arrayHistoryCreditos.push("No hay carreras para debitar al driver id "+e.driver_id+" de la fecha "+t+" ("+d()().format("LTS")+")");case 28:case"end":return s.stop()}}),s,null,[[10,22]])})))()},verificarCreditos:function(e,a,t){var r=this;return n()(o.a.mark((function s(){var i,c,n;return o.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=0,s.next=3,r.getDriverJugno(e.driver_id);case 3:if(c=s.sent,null==c){s.next=12;break}return n=c.wallet_balance,r.arrayHistoryCreditos.push("Verificando sus creditos para bloquear al driver id "+e.driver_id+" ("+d()().format("LTS")+")"),0==c.Suspended?parseInt(n)<=0?(r.arrayHistoryCreditos.push("Bloqueando al Driver ID: "+e.driver_id+" ("+d()().format("LTS")+")"),i=1,r.bloquearDriver(e),r.arrayMotosCSV.push(e.driver_id+",-,"+parseInt(a)+","+parseInt(n)+",SI,"+t+"\n")):(i=0,r.arrayHistoryCreditos.push("Tiene "+n+" creditos, no se bloqueara al driver id "+e.driver_id+" ("+d()().format("LTS")+")"),r.arrayMotosCSV.push(e.driver_id+",-,"+parseInt(a)+","+parseInt(n)+",NO,"+t+"\n")):(i=0,r.arrayHistoryCreditos.push("El driver id "+e.driver_id+" Ya esta bloqueado ("+d()().format("LTS")+")")),s.next=10,r.actualizarCreditosEstadoDriver(n,i,e);case 10:s.next=14;break;case 12:r.arrayHistoryCreditos.push("Driver id "+e.driver_id+" No se pudo obtener los creditos actuales ("+d()().format("LTS")+")"),console.log("No se pudo obtener el DRIVER ID "+e.driver_id);case 14:case"end":return s.stop()}}),s)})))()},getDriverJugno:function(e){var a=this;return n()(o.a.mark((function t(){var r,s,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://api-panels.jugnoo.in:7013/schedule-ride-auth/driver_info?",s=new URLSearchParams,s.append("driver_id",e),s.append("token",a.access_token_aux),s.append("search_key",0),s.append("paginationDetails[start_from_rides]",0),s.append("paginationDetails[page_size_rides]",40),s.append("paginationDetails[start_from_issues]",0),s.append("paginationDetails[start_from_app_issues]",0),s.append("paginationDetails[page_size_issues]",40),s.append("paginationDetails[page_size_app_issues]",40),s.append("paginationDetails[start_from_dodo]",0),s.append("paginationDetails[page_size_dodo]",40),s.append("paginationDetails[start_from_can_rides]",0),s.append("paginationDetails[page_size_can_rides]",40),s.append("paginationDetails[start_from_agent_history]",0),s.append("paginationDetails[page_size_agent_history]",40),t.prev=17,t.next=20,a.$axios.post(r,s);case 20:if(i=t.sent,!i.data.wallet_balance){t.next=25;break}return t.abrupt("return",i.data);case 25:return t.abrupt("return",null);case 26:t.next=31;break;case 28:t.prev=28,t.t0=t["catch"](17),console.log("GET DRIVER JUGNO",t.t0);case 31:case"end":return t.stop()}}),t,null,[[17,28]])})))()},bloquearDriver:function(e){var a=this;return n()(o.a.mark((function t(){var r,s;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://api-panels.jugnoo.in:8020/suspend_driver?",s=new URLSearchParams,s.append("suspension_reason_id",2745),s.append("suspension_reason_text","Otros"),s.append("driver_id[]",e.driver_id),s.append("suspend_comments","Creditos en contra, debe recargar para activarse"),s.append("admin_email",""),s.append("token",a.access_token_aux),s.append("email_id","abhishek.kaushik+patio@jungleworks.com"),s.append("city",a.citySelect),s.append("suspension_type",2),t.prev=11,t.next=14,a.$axios.post(r,s);case 14:t.sent,a.arrayHistoryCreditos.push(e.driver_id+" Bloqueado hasta su proxima recarga  ("+d()().format("LTS")+")"),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](11),console.log("No se pudo bloquear el id "+e.driver_id,t.t0);case 21:case"end":return t.stop()}}),t,null,[[11,18]])})))()},actualizarCreditosEstadoDriver:function(e,a,t){var r=this;return n()(o.a.mark((function s(){var i,c,n;return o.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r.arrayHistoryCreditos.push(t.driver_id+" Actualizando Creditos y estado ("+d()().format("LTS")+")"),i="https://patioserviceonline.com/api/v1/?route=driver&type=creditos_estado_driver_id",c=new URLSearchParams,c.append("creditos",e),c.append("estado",a),c.append("id_jugno",t.driver_id),s.prev=6,s.next=9,r.$axios.post(i,c);case 9:n=s.sent,console.log("Creditos y estado driver ID "+t.driver_id,n.data),r.arrayHistoryCreditos.push(t.driver_id+" Creditos y estado actualizados  ("+d()().format("LTS")+")"),s.next=18;break;case 14:s.prev=14,s.t0=s["catch"](6),console.log("Actualizando estado ERROR",s.t0),r.arrayHistoryCreditos.push(t.driver_id+" No se actualizaron los Creditos y el estado ("+d()().format("LTS")+")");case 18:case"end":return s.stop()}}),s,null,[[6,14]])})))()},asyncForEach:function(e,a){var t=this;return n()(o.a.mark((function r(){var s;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:s=0;case 1:if(!(s<e.length)){r.next=8;break}return r.next=4,a(e[s],s,e);case 4:t.contadorCreditos=s+1+" de "+e.length;case 5:s++,r.next=1;break;case 8:case"end":return r.stop()}}),r)})))()},reset_timer_creditos:function(){var e=this;clearTimeout(this.refresh_handler_creditos),this.refresh_handler_creditos=setTimeout((function(){e.comprobarHora(),console.log("Refresh CREDITOS...")}),6e4*this.time_refresh_creditos)},cargarCiudad:function(){this.citySelect=u["a"].getItem("ciudad")||395},cambiarCiudad:function(){switch(this.citySelect){case 395:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-17.783384,-63.18203]);break;case 704:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-17.393868,-66.157481]);break;case 818:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-16.505147,-68.129631]);break;case 1796:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-19.573203,-65.757626]);break;case 859:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-21.533739,-64.733768]);break;case 933:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-19.043361,-65.260071]);break;case 786:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-16.398879,-71.536884]);break;case 997:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-34.885591,-56.165964]);break;case 3190:u["a"].set("ciudad",this.citySelect),u["a"].set("center",[-34.339696,-56.71345]);break}location.reload()},validateNumber:function(){(this.time_refresh<1||""==this.time_refresh||null==this.time_refresh)&&(this.time_refresh=60)},validateNumberDelivery:function(){(this.time_refresh_delivery<1||""==this.time_refresh_delivery||null==this.time_refresh_delivery)&&(this.time_refresh_delivery=60)},change_mode:function(){this.active?(this.getOrders(),this.arrayHistory.push("El sistema MENUS esta ACTIVADO ("+d()().format("LTS")+")")):(clearTimeout(this.refresh_handler),this.arrayHistory.push("El Sistema MENUS esta DETENIDO ("+d()().format("LTS")+")"))},change_mode_accept:function(){this.activeAccept?(this.getOrdersAccept(),this.arrayHistory.push("El sistema ACEPTAR esta ACTIVADO ("+d()().format("LTS")+")")):(clearTimeout(this.refresh_handler_accept),this.arrayHistory.push("El Sistema ACEPTAR esta DETENIDO ("+d()().format("LTS")+")"))},change_mode_delivery:function(){this.activeDelivery?(this.getOrdersDelivery(),this.arrayHistoryDelivery.push("El sistema DELIVERY esta ACTIVADO ("+d()().format("LTS")+")")):(clearTimeout(this.refresh_handler_delivery),this.arrayHistoryDelivery.push("El Sistema DELIVERY esta DETENIDO ("+d()().format("LTS")+")"))},reset_timer:function(){var e=this;clearTimeout(this.refresh_handler),this.refresh_handler=setTimeout((function(){e.getOrders(),console.log("Refresh MENUS...")}),1e3*this.time_refresh)},reset_timer_accept:function(){var e=this;clearTimeout(this.refresh_handler_accept),this.refresh_handler_accept=setTimeout((function(){e.getOrdersAccept(),console.log("Refresh ACCEPT...")}),6e4*this.time_refresh_accept)},reset_timer_delivery:function(){var e=this;clearTimeout(this.refresh_handler_delivery),this.refresh_handler_delivery=setTimeout((function(){e.getOrdersDelivery(),console.log("Refresh DELIVERY...")}),1e3*this.time_refresh_delivery)},getOrdersDelivery:function(){var e=this;return n()(o.a.mark((function a(){var t,r,s,i;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.activeDelivery){a.next=16;break}return console.log("FINDING ORDERS DELIVERY..."),e.arrayHistoryDelivery.push("Obteniendo lista de ordenes DELIVERY... ("+d()().format("LTS")+")"),t=Date.now(),r=d()().format("YYYY-MM-DD"),s="https://prod-fatafat-new.jugnoo.in:4030/panel/view_orders?token="+e.access_token+"&secret=P7JlZXiRiIvSssQSSzqs&city_id="+e.citySelect+"&start_date="+r+"&end_date="+r+"&fetch_active_orders=1&sEcho=1&iColumns=12&sColumns=%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C&iDisplayStart=0&iDisplayLength=100&mDataProp_0=&sSearch_0=&bRegex_0=false&bSearchable_0=true&bSortable_0=true&mDataProp_1=&sSearch_1=&bRegex_1=false&bSearchable_1=true&bSortable_1=false&mDataProp_2=&sSearch_2=&bRegex_2=false&bSearchable_2=true&bSortable_2=false&mDataProp_3=&sSearch_3=&bRegex_3=false&bSearchable_3=true&bSortable_3=false&mDataProp_4=&sSearch_4=&bRegex_4=false&bSearchable_4=true&bSortable_4=false&mDataProp_5=&sSearch_5=&bRegex_5=false&bSearchable_5=true&bSortable_5=false&mDataProp_6=&sSearch_6=&bRegex_6=false&bSearchable_6=true&bSortable_6=false&mDataProp_7=&sSearch_7=&bRegex_7=false&bSearchable_7=true&bSortable_7=false&mDataProp_8=&sSearch_8=&bRegex_8=false&bSearchable_8=true&bSortable_8=false&mDataProp_9=&sSearch_9=&bRegex_9=false&bSearchable_9=true&bSortable_9=false&mDataProp_10=&sSearch_10=&bRegex_10=false&bSearchable_10=true&bSortable_10=false&mDataProp_11=&sSearch_11=&bRegex_11=false&bSearchable_11=true&bSortable_11=false&sSearch=&bRegex=false&iSortCol_0=0&sSortDir_0=desc&iSortingCols=1&_="+t,a.prev=6,a.next=9,e.$axios.get(s);case 9:i=a.sent,e.filterOrderDelivery(i.data.aaData),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](6),console.log("GET ORDERS DELIVERY PENDING ERROR: "+a.t0);case 16:e.reset_timer_delivery();case 17:case"end":return a.stop()}}),a,null,[[6,13]])})))()},getOrdersAccept:function(){var e=this;return n()(o.a.mark((function a(){var t,r,s,i;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.activeAccept){a.next=16;break}return console.log("FINDING ORDERS ACCEPT..."),e.arrayHistory.push("Obteniendo lista de ordenes para ACEPTAR... ("+d()().format("LTS")+")"),t=Date.now(),r=d()().format("YYYY-MM-DD"),s="https://prod-fresh-api.jugnoo.in:4040/admin/get_orders?token="+e.access_token+"&secret=P7JlZXiRiIvSssQSSzqs&city="+e.citySelect+"&start_date="+r+"&end_date="+r+"&fetch_pending_orders=1&statusCopy=[object%20Object]&status=0,1&sEcho=1&iColumns=12&sColumns=%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C&iDisplayStart=0&iDisplayLength=100&mDataProp_0=&sSearch_0=&bRegex_0=false&bSearchable_0=true&bSortable_0=true&mDataProp_1=1&sSearch_1=&bRegex_1=false&bSearchable_1=true&bSortable_1=false&mDataProp_2=2&sSearch_2=&bRegex_2=false&bSearchable_2=true&bSortable_2=false&mDataProp_3=3&sSearch_3=&bRegex_3=false&bSearchable_3=true&bSortable_3=false&mDataProp_4=&sSearch_4=&bRegex_4=false&bSearchable_4=true&bSortable_4=false&mDataProp_5=5&sSearch_5=&bRegex_5=false&bSearchable_5=true&bSortable_5=false&mDataProp_6=6&sSearch_6=&bRegex_6=false&bSearchable_6=true&bSortable_6=false&mDataProp_7=7&sSearch_7=&bRegex_7=false&bSearchable_7=true&bSortable_7=false&mDataProp_8=8&sSearch_8=&bRegex_8=false&bSearchable_8=true&bSortable_8=false&mDataProp_9=9&sSearch_9=&bRegex_9=false&bSearchable_9=true&bSortable_9=false&mDataProp_10=10&sSearch_10=&bRegex_10=false&bSearchable_10=true&bSortable_10=false&mDataProp_11=&sSearch_11=&bRegex_11=false&bSearchable_11=true&bSortable_11=false&sSearch=&bRegex=false&iSortCol_0=0&sSortDir_0=desc&iSortingCols=1&_= "+t,a.prev=6,a.next=9,e.$axios.get(s);case 9:i=a.sent,e.filterOrderAccept(i.data.aaData),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](6),console.log("GET ORDERS ACCEPT ERROR: ",a.t0);case 16:e.reset_timer_accept();case 17:case"end":return a.stop()}}),a,null,[[6,13]])})))()},getOrders:function(){var e=this;return n()(o.a.mark((function a(){var t,r,s,i;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.active){a.next=16;break}return console.log("FINDING ORDERS MENUS..."),e.arrayHistory.push("Obteniendo lista de ordenes MENUS... ("+d()().format("LTS")+")"),t=Date.now(),r=d()().format("YYYY-MM-DD"),s="https://prod-fresh-api.jugnoo.in:4040/admin/get_orders?token="+e.access_token+"&secret=P7JlZXiRiIvSssQSSzqs&city="+e.citySelect+"&start_date="+r+"&end_date="+r+"&fetch_pending_orders=1&statusCopy=[object%20Object]&status=8&sEcho=1&iColumns=12&sColumns=%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C%2C&iDisplayStart=0&iDisplayLength=500&mDataProp_0=&sSearch_0=&bRegex_0=false&bSearchable_0=true&bSortable_0=true&mDataProp_1=1&sSearch_1=&bRegex_1=false&bSearchable_1=true&bSortable_1=false&mDataProp_2=2&sSearch_2=&bRegex_2=false&bSearchable_2=true&bSortable_2=false&mDataProp_3=3&sSearch_3=&bRegex_3=false&bSearchable_3=true&bSortable_3=false&mDataProp_4=&sSearch_4=&bRegex_4=false&bSearchable_4=true&bSortable_4=false&mDataProp_5=5&sSearch_5=&bRegex_5=false&bSearchable_5=true&bSortable_5=false&mDataProp_6=6&sSearch_6=&bRegex_6=false&bSearchable_6=true&bSortable_6=false&mDataProp_7=7&sSearch_7=&bRegex_7=false&bSearchable_7=true&bSortable_7=false&mDataProp_8=8&sSearch_8=&bRegex_8=false&bSearchable_8=true&bSortable_8=false&mDataProp_9=9&sSearch_9=&bRegex_9=false&bSearchable_9=true&bSortable_9=false&mDataProp_10=10&sSearch_10=&bRegex_10=false&bSearchable_10=true&bSortable_10=false&mDataProp_11=&sSearch_11=&bRegex_11=false&bSearchable_11=true&bSortable_11=false&sSearch=&bRegex=false&iSortCol_0=0&sSortDir_0=desc&iSortingCols=1&_= "+t,a.prev=6,a.next=9,e.$axios.get(s);case 9:i=a.sent,e.filterOrderUnasigned(i.data.aaData),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](6),console.log("GET ORDERS MENUS PENDING ERROR: ",a.t0);case 16:e.reset_timer();case 17:case"end":return a.stop()}}),a,null,[[6,13]])})))()},filterOrderDelivery:function(e){this.cantOrdersTotalDelivery=e.length;for(var a=0;a<e.length;a++){var t=e[a].status,r=e[a].dodo_delivery_id,s=e[a].order_id;0==t&&this.getDeliveryStatus(r,s)}},filterOrderAccept:function(e){for(var a=this,t=function(t){var r=e[t][13].status;if(0==r){var s=[36626,40376,41817,41816,41815,41813],i=s.find((function(a){return a==e[t][13].restaurant_id}));if(!i){var o=e[t][13].restaurant_id,c=e[t][13].order_id,n=e[t][13].user_id,l=e[t][7].split("<br/>")[0],u=e[t][7].split("<br/>")[1],p=u.split("-")[1],_=u.split("-")[0],h=u.split("-")[0].substring(0,_.length-2),b=u.split("-")[2],f="PM"==l.split(":")[1].split(" ")[1]&&"12"!=l.split(":")[0]?1*l.split(":")[0]+12:l.split(":")[0],v=l.split(":")[1].split(" ")[0],m=p+" "+h+", "+b+" "+f+":"+v+":00",y=new Date(m).getTime(),S=Date.now(),g=d()(S-y).format("mm");g>=5&&a.acceptOrder(c,o,n)}}},r=0;r<e.length;r++)t(r)},acceptOrder:function(e,a,t){var r=this;return n()(o.a.mark((function s(){var i,c;return o.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i="https://prod-fresh-api.jugnoo.in:4040/web/accept_order",c="token="+r.access_token+"&order_id="+e+"&restaurant_id="+a+"&user_id="+t+"&force_token=1&refund_customer=0&reason=",s.prev=2,s.next=5,r.$axios({url:i,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:c});case 5:s.sent,r.arrayHistory.push("ORDER_ID: "+e+" ACEPTADO correctamente! ("+d()().format("LTS")+")"),r.cantOrderAccept++,s.next=14;break;case 10:s.prev=10,s.t0=s["catch"](2),console.log("AUTO ASIGNAR ERROR: ",s.t0),r.arrayHistory.push("ORDER_ID: "+e+" NO SE PUDO ACEPTAR ("+d()().format("LTS")+")");case 14:case"end":return s.stop()}}),s,null,[[2,10]])})))()},filterOrderUnasigned:function(e){this.cantOrdersTotal=e.length;for(var a=0;a<e.length;a++){var t=e[a][13].status,r=e[a][13].restaurant_id,s=e[a][13].order_id,i=(e[a][10],e[a][9]);0!=t&&"-"==i&&this.getDeliveryID(s,r)}},getDeliveryStatus:function(e,a){var t=this;return n()(o.a.mark((function r(){var s,i,c;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.arrayHistoryDelivery.push("Verificando para Auto Asignar Orden ID "+a+" DELIVERY ID "+e+" ("+d()().format("LTS")+")"),s="https://dodo.jugnoo.in:8024/get_complete_task_details",i="access_token="+t.access_token+"&order_id="+e,r.prev=3,r.next=6,t.$axios({url:s,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:i});case 6:c=r.sent,6==c.data.data.status?(t.arrayHistoryDelivery.push("Auto Asignando Orden ID "+a+" DELIVERY ID "+e+" ("+d()().format("LTS")+")"),t.autoAssignDelivery(e)):t.arrayHistoryDelivery.push("No necesita Auto Asignar Orden ID "+a+" DELIVERY ID "+e+" ("+d()().format("LTS")+")"),r.next=12;break;case 10:r.prev=10,r.t0=r["catch"](3);case 12:case"end":return r.stop()}}),r,null,[[3,10]])})))()},getDeliveryID:function(e,a){var t=this;return n()(o.a.mark((function r(){var s,i,c,n;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s="https://prod-fresh-api.jugnoo.in:4040/order_details",i="token="+t.access_token+"&order_id="+e+"&restaurant_id="+a,r.prev=2,r.next=5,t.$axios({url:s,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:i});case 5:c=r.sent,n=c.data.order_info[0].delivery_id,t.arrayHistory.push("Auto Asignando ORDER_ID: "+e+" RESTAURANT_ID: "+a+" DELIVERY_ID: "+n+"... ("+d()().format("LTS")+")"),t.autoAssignMenus(n),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](2),console.log("GET DELIVERY ID ERROR: "+r.t0);case 14:case"end":return r.stop()}}),r,null,[[2,11]])})))()},autoAssignDelivery:function(e){var a=this;return n()(o.a.mark((function t(){var r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://dodo.jugnoo.in:8024/assign_driver",t.prev=1,t.next=4,a.$axios.post(r,{access_token:a.access_token,order_id:e,user_id:null});case 4:t.sent,a.arrayHistoryDelivery.push("DELIVERY_ID: "+e+" Auto Asignado con exito! ("+d()().format("LTS")+")"),a.cantOrderAssignedDelivery++,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log("AUTO ASIGNAR ERROR: "+t.t0),a.arrayHistoryDelivery.push("DELIVERY_ID: "+e+" NO SE PUDO AUTO ASIGNAR ("+d()().format("LTS")+")");case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},autoAssignMenus:function(e){var a=this;return n()(o.a.mark((function t(){var r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://dodo.jugnoo.in:8024/assign_driver",t.prev=1,t.next=4,a.$axios.post(r,{access_token:a.access_token,order_id:e,user_id:null});case 4:t.sent,a.arrayHistory.push("DELIVERY_ID: "+e+" Auto Asignado con exito! ("+d()().format("LTS")+")"),a.cantOrderAssigned++,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log("AUTO ASIGNAR ERROR: "+t.t0),a.arrayHistory.push("DELIVERY_ID: "+e+" NO SE PUDO AUTO ASIGNAR ("+d()().format("LTS")+")");case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()}}},h=_,b=t("2877"),f=t("9989"),v=t("ddd8"),m=t("eb85"),y=t("27f9"),S=t("9564"),g=t("b047"),D=t("cb32"),C=t("f09f"),x=t("a370"),j=t("4983"),R=t("9c40"),k=t("8f8e"),E=t("eebe"),w=t.n(E),A=Object(b["a"])(h,r,s,!1,null,null,null);a["default"]=A.exports;w()(A,"components",{QPage:f["a"],QSelect:v["a"],QSeparator:m["a"],QInput:y["a"],QToggle:S["a"],QChip:g["a"],QAvatar:D["a"],QCard:C["a"],QCardSection:x["a"],QScrollArea:j["a"],QBtn:R["a"],QCheckbox:k["a"]})},4678:function(e,a,t){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"73332","./en-il.js":"73332","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df48","./fa.js":"8df48","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b46","./gd.js":"f6b46","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var a=i(e);return t(a)}function i(e){if(!t.o(r,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return r[e]}s.keys=function(){return Object.keys(r)},s.resolve=i,e.exports=s,s.id="4678"}}]);